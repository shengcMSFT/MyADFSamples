This is a sample Power Shell script to help you configure NSG rules to allow inbound 443 ports from Azure IP ranges from a selected data center. You can modify the script for different rules you would like to set in batch.

Store in repo just for easy reference. Full credits to author @KeithMayer, details can be found below: 

[Step-by-Step: Automate Building Outbound Network Security Groups Rules via Azure Resource Manager (ARM) and PowerShell](https://blogs.technet.microsoft.com/keithmayer/2016/01/12/step-by-step-automate-building-outbound-network-security-groups-rules-via-azure-resource-manager-arm-and-powershell/)